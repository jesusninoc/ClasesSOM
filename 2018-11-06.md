# Obtener información sobre los procesos que se están ejecutando (cmdlet)
```PowerShell
Get-Process
```

# Obtener información sobre los procesos que se están ejecutando (WMI)
```PowerShell
Get-WmiObject win32_process
```

# Mostrar la descripción y la ruta de los procesos que se están ejecutando. Para ver la mayor cantidad de información sobre procesos es necesario ejecutar PowerShell como administrador
```PowerShell
Get-Process | Select-Object Description,Path
```

# Mostrar la línea de comando que se está ejecutando para cada proceso
```PowerShell
Get-WmiObject win32_process | Sort-Object Processid | Select-Object Processid,Name,CommandLine
```

# Get-Date
https://github.com/jesnino/PowerShell/blob/master/Fechas/EjemplosFechas.ps1

## Ejemplos con fechas
```PowerShell
ls | where CreationTime -LT (get-date)
ls | where CreationTime -lt (get-date).AddDays(-1)
ls | where CreationTime -gt (get-date)
```
```PowerShell
#Fecha exacta
dir | ? {$_.lastwritetime -gt ‘1/1/18’ -AND $_.lastwritetime -lt ‘6/1/18’}
```

# Ejercicios sobre procesos y fechas
## Help
``` PowerShell
Get-Process | select name

mkdir (Get-Process | select name).name -force

ni -Path .\chrome -Value ([String](Get-Process -name chrome)) -Name informacion.txt

ForEach ($ellos in (Get-Process | select name).name)
{
    ni -Path $ellos -Value ([String](Get-Process -name $ellos)) -Name informacion.txt -force
}

(Get-Process | select name).name | %{
     ni -Path $_ -Value ([String](Get-Process -name $_)) -Name informacion.txt -force
}
```
## Crear carpetas cada día de la semana para cada proceso y almacenar en cada carpeta información de los procesos.
``` PowerShell
$dias=1

while(1)
{
    mkdir (Get-Date).Year; cd (Get-Date).Year
    mkdir (Get-Date).Month; cd (Get-Date).Month
    mkdir (Get-Date).AddDays(1).Day; cd (Get-Date).AddDays(1).Day

    $dias=$dias+1

    if($dias -lt 7)
    {
        (ps | select name).name | %{
        ni -Path $_ -Value ([string](ps -Name $_)) -name informacion.txt -force
        }
        break
    }
    else
    {
    }
    
    cd ..
    cd ..
    cd ..
    Start-Sleep -Seconds (24*60*60)
}
```
activdad  Powershell
```PowerShell
$dias=1

while(1)
{
    foreach ($elementos in (gwmi win32_process | Select name).name) #cambiar guet-process del script de clase y poner gwmi win32_process 
    {
    ni -Path $elementos -value ([String](Gwmi win32_process)) -name informacion.txt -Force
    }
    $dias=$dias+1

    if($dias -eq 8)       #Se pone esto para que se realice durante una semana. 
    {
        "dia 7!!"
        break
    }
    else
    {
        "no hemos acabado"
    }
    Start-Sleep (24*60*60)  # Para que se guarde la información cada dia automaticamente.
}
``` 
